var $taskBoard=$("#sc-task-board"),tasks=[];scutum.pages.taskBoard={},scutum.pages.taskBoard.init=function(){scutum.pages.taskBoard.listsDragDrop(),scutum.pages.taskBoard.cardsDragDrop(),scutum.pages.taskBoard.taskModal(),scutum.pages.taskBoard.list.shrink(),scutum.pages.taskBoard.list.expand(),scutum.pages.taskBoard.list.addCard()},scutum.pages.taskBoard.cardsDragDrop=function(){scutum.require(["dragula"],function(){for(var a=dragula($(".sc-task-list-cards").toArray()),s=a.containers,t=s.length,e=0;e<t;e++)$(s[e]).addClass("dragula dragula-vertical");a.on("drag",function(a,s){$(a).addClass("sc-mirror-el")}),a.on("dragend",function(a){$(a).removeClass("sc-mirror-el")}),a.on("drop",function(a,s,t,e){console.log(a),console.log(s),console.log(t)})})},scutum.pages.taskBoard.listsDragDrop=function(){scutum.require(["dragula"],function(){for(var a=dragula($(".sc-task-board").toArray(),{direction:"horizontal",moves:function(a,s,t){return $(t).closest(".dragula-handle-el").length}}),s=a.containers,t=s.length,e=0;e<t;e++)$(s[e]).addClass("dragula dragula-handle");a.on("drop",function(a,s,t,e){console.log(a),console.log(s),console.log(t)})})},scutum.pages.taskBoard.list={shrink:function(){$taskBoard.on("click",".sc-js-list-collapse",function(a){a.preventDefault();a=$(this).closest(".sc-task-list");a.addClass("sc-task-list-collapsed"),scutum.helpers.hideDuringTransform(a)})},expand:function(){$taskBoard.on("click",".sc-js-list-expand",function(a){a.preventDefault();a=$(this).closest(".sc-task-list");a.removeClass("sc-task-list-collapsed"),scutum.helpers.hideDuringTransform(a)})}},scutum.pages.taskBoard.taskModal=function(){scutum.require(["handlebars"],function(){var a=$("#sc-task-modal"),t=$("#sc-hb-task-modal"),e=UIkit.modal(a);scutum.helpers.ajax("data/pages/tasks.json","GET","json").then(function(a){tasks=a}).catch(function(a){throw console.log("There has been a error: "+a.message),a}),scutum.$body.on("click",".sc-task-card",function(){var a=$(this).attr("data-task-id");a&&scutum.helpers.findObjectByKey(tasks,"id",parseInt(a)).then(function(a,s){a&&t.one("render.handlebars",function(a,s){e.show()}).hbRender("task-modal",{title:a.title,date:a.date,list:a.list_long,description:a.description,tags:a.tags,assignee:a.assignee,progress:a.progress})})})},!1)},scutum.pages.taskBoard.list.addCard=function(){scutum.require(["handlebars","flatpickr"],function(){var a=$("#sc-task-board-card-add-modal"),t=UIkit.modal(a,{bgClose:!1});UIkit.util.on("#sc-task-board-card-add-modal","shown",function(){$("#card-add-title").focus(),$("#card-add-tags").trigger("change"),$("#card-add-assignee").trigger("change")}),flatpickr("#card-add-due-date",{dateFormat:"d/m/Y",minDate:moment().format("DD/MM/YYYY")}),$("#card-add-tags").select2({placeholder:"Select tags",closeOnSelect:!1}),$("#card-add-assignee").select2({placeholder:"Select assignee",closeOnSelect:!1});var e=null,d=null,r="";scutum.$body.on("click",".sc-js-card-add-modal",function(){var a=$(this);switch(e=a.closest(".sc-task-list"),d=e.attr("data-list-name")){case"to_do":r="To Do";break;case"in_progress":r="In Progress";break;case"testing":r="Testing";break;case"done":r="Done";break;default:r=""}t.show()}),scutum.$body.on("click","#sc-js-card-add",function(a){a.preventDefault();var s={id:Math.floor(1e3*Math.random()+100),list:d,list_long:r,title:$("#card-add-title").val(),date:$("#card-add-due-date").val(),tags:$("#card-add-tags").val(),description:$("#card-add-description").val(),assignee:$("#card-add-assignee").val()};e.children(".sc-task-list-cards").one("render.handlebars",function(){t.hide(),tasks.push(s),$("#card-add-title").val(""),$("#card-add-due-date").val(""),$("#card-add-tags").val(null).trigger("change"),$("#card-add-description").val(""),$("#card-add-assignee").val(null).trigger("change")}).hbRender("task-card-add",{id:s.id,title:s.title,description:s.description,date:s.date,tags:s.tags,assignee:s.assignee,list:s.list,list_long:s.list_long},!0)})},!1)};